@page "/register"

<EditForm Model="registerModel" OnValidSubmit="HandleRegister">
    <MudTextField @bind-Value="@registerModel.Email" Label="Email" InputType="InputType.Email" />
    <MudTextField @bind-Value="@registerModel.Password" Label="Password" InputType="InputType.Password" />
    <MudTextField @bind-Value="@registerModel.ConfirmPassword" Label="Confirm Password" InputType="InputType.Password" />
    <MudButton ButtonType="ButtonType.Submit" Color="Color.Primary">Register</MudButton>
</EditForm>

@code {
    private RegisterViewModel registerModel = new RegisterViewModel();

    private async Task HandleRegister()
    {
        var result = await ApiService.PostAsync("api/auth/register", registerModel);
        if (result != null && result.Response == "User created successfully")
        {
            Snackbar.Add("User created successfully", Severity.Success);
            Navigation.NavigateTo($"/users/emailsent?email={registerModel.Email}");
        }
        else
        {
            Snackbar.Add("Failed to create user", Severity.Error);
        }        
    }
}